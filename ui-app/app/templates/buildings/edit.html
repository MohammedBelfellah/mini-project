{% extends "base.html" %}

{% block title %}Modifier un Bâtiment{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h1><i class="bi bi-pencil"></i> Modifier un Bâtiment</h1>
    <a href="{{ url_for('buildings.view_building', id=building[0]) }}" class="btn btn-secondary">
        <i class="bi bi-arrow-left"></i> Retour
    </a>
</div>

<div class="card">
    <div class="card-body">
        <form method="POST" action="{{ url_for('buildings.edit_building', id=building[0]) }}">
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="nom_batiment" class="form-label">Nom du Bâtiment <span class="text-danger">*</span></label>
                    <input type="text" class="form-control" id="nom_batiment" name="nom_batiment" value="{{ building[1] }}" required>
                </div>
                
                <div class="col-md-6 mb-3">
                    <label for="adresse_rue" class="form-label">Adresse</label>
                    <input type="text" class="form-control" id="adresse_rue" name="adresse_rue" value="{{ building[2] or '' }}">
                </div>
            </div>

            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="latitude" class="form-label">Latitude</label>
                    <input type="number" step="0.000001" class="form-control" id="latitude" name="latitude" value="{{ building[3] or '' }}">
                </div>
                
                <div class="col-md-6 mb-3">
                    <label for="longitude" class="form-label">Longitude</label>
                    <input type="number" step="0.000001" class="form-control" id="longitude" name="longitude" value="{{ building[4] or '' }}">
                </div>
            </div>

            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="date_construction" class="form-label">Date de Construction</label>
                    <input type="date" class="form-control" id="date_construction" name="date_construction" 
                           value="{{ building[5].strftime('%Y-%m-%d') if building[5] else '' }}">
                </div>
                
                <div class="col-md-6 mb-3">
                    <label for="id_zone" class="form-label">Zone Urbaine</label>
                    <select class="form-select" id="id_zone" name="id_zone">
                        <option value="">-- Sélectionner --</option>
                        {% for zone in zones %}
                        <option value="{{ zone[0] }}" {% if building[11] == zone[0] %}selected{% endif %}>{{ zone[1] }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 mb-3">
                    <label for="id_type" class="form-label">Type de Bâtiment</label>
                    <select class="form-select" id="id_type" name="id_type">
                        <option value="">-- Sélectionner --</option>
                        {% for type in types %}
                        <option value="{{ type[0] }}" {% if building[12] == type[0] %}selected{% endif %}>{{ type[1] }}</option>
                        {% endfor %}
                    </select>
                </div>
                
                <div class="col-md-4 mb-3">
                    <label for="id_protection" class="form-label">Niveau de Protection</label>
                    <select class="form-select" id="id_protection" name="id_protection">
                        <option value="">-- Sélectionner --</option>
                        {% for protection in protections %}
                        <option value="{{ protection[0] }}" {% if building[13] == protection[0] %}selected{% endif %}>{{ protection[1] }}</option>
                        {% endfor %}
                    </select>
                </div>
                
                <div class="col-md-4 mb-3">
                    <label for="id_proprio" class="form-label">Propriétaire</label>
                    <select class="form-select" id="id_proprio" name="id_proprio">
                        <option value="">-- Sélectionner --</option>
                        {% for proprio in proprietaires %}
                        <option value="{{ proprio[0] }}" {% if building[14] == proprio[0] %}selected{% endif %}>{{ proprio[1] }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>

            <div class="mb-3">
                <label for="note_historique" class="form-label">Note Historique</label>
                <textarea class="form-control" id="note_historique" name="note_historique" rows="4">{{ building[6] or '' }}</textarea>
            </div>

            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                <a href="{{ url_for('buildings.view_building', id=building[0]) }}" class="btn btn-secondary">
                    <i class="bi bi-x-circle"></i> Annuler
                </a>
                <button type="submit" class="btn btn-warning">
                    <i class="bi bi-check-circle"></i> Mettre à Jour
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}